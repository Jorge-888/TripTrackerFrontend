<div style="padding:1.5rem;">
    <!-- Header -->
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;">
        <div style="display:flex;align-items:center;gap:0.75rem;">
            <i class="pi pi-eye" style="font-size:1.5rem;color:#875D4A;"></i>
            <h2 style="margin:0;color:#111;font-size:1.75rem;font-weight:600;">Detalles del Viaje</h2>
        </div>
        <p-button icon="pi pi-times" (onClick)="onClose()" [rounded]="true" [text]="true"
            [style]="{ 'color': '#64748b' }">
        </p-button>
    </div>

    <!-- Card 1: Información del Viaje -->
    <p-card styleClass="mb-3"
        [style]="{ 'border': '1px solid #e9e2db', 'border-radius': '12px', 'margin-bottom': '1.5rem' }">
        <ng-template pTemplate="header">
            <div style="padding:1.25rem 1.5rem;background:#f8fafc;border-bottom:2px solid #875D4A;">
                <h3 style="margin:0;color:#111;font-size:1.25rem;font-weight:600;">
                    <i class="pi pi-info-circle" style="color:#875D4A;margin-right:0.5rem;"></i>
                    Información del Viaje
                </h3>
            </div>
        </ng-template>

        <ng-template pTemplate="content">
            <div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:1.5rem;">
                <div>
                    <p style="margin:0;color:#64748b;font-size:0.85rem;font-weight:500;">Fecha del Viaje</p>
                    <p style="margin:0.25rem 0 0;color:#111;font-size:1.125rem;font-weight:600;">
                        {{ formatFecha(viaje.viaj_Fecha) }}
                    </p>
                </div>

                <div>
                    <p style="margin:0;color:#64748b;font-size:0.85rem;font-weight:500;">Sucursal</p>
                    <p style="margin:0.25rem 0 0;color:#111;font-size:1.125rem;font-weight:600;">
                        {{ viaje.sucu_Descripcion }}
                    </p>
                </div>

                <div>
                    <p style="margin:0;color:#64748b;font-size:0.85rem;font-weight:500;">Transportista</p>
                    <p style="margin:0.25rem 0 0;color:#111;font-size:1.125rem;font-weight:600;">
                        {{ getTransportistaNombre() }}
                    </p>
                    <p style="margin:0.25rem 0 0;color:#64748b;font-size:0.85rem;">
                        DNI: {{ viaje.trpo_DNI }}
                    </p>
                </div>

                <div>
                    <p style="margin:0;color:#64748b;font-size:0.85rem;font-weight:500;">Vehículo</p>
                    <p style="margin:0.25rem 0 0;color:#111;font-size:1.125rem;font-weight:600;">
                        {{ viaje.trpo_Vehiculo }}
                    </p>
                    <p style="margin:0.25rem 0 0;color:#64748b;font-size:0.85rem;">
                        Placa: {{ viaje.trpo_Placa }}
                    </p>
                </div>

                <div>
                    <p style="margin:0;color:#64748b;font-size:0.85rem;font-weight:500;">Tarifa por KM</p>
                    <p style="margin:0.25rem 0 0;color:#875D4A;font-size:1.25rem;font-weight:700;">
                        L {{ viaje.viaj_TarifaKM | number:'1.2-2' }}
                    </p>
                </div>

                <div>
                    <p style="margin:0;color:#64748b;font-size:0.85rem;font-weight:500;">Tarifa Total</p>
                    <p style="margin:0.25rem 0 0;color:#875D4A;font-size:1.25rem;font-weight:700;">
                        L {{ viaje.viaj_TarifaTotal | number:'1.2-2' }}
                    </p>
                </div>
            </div>
        </ng-template>
    </p-card>

    <!-- Card 2: Colaboradores -->
    <p-card styleClass="mb-3"
        [style]="{ 'border': '1px solid #e9e2db', 'border-radius': '12px', 'margin-bottom': '1.5rem' }">
        <ng-template pTemplate="header">
            <div style="padding:1.25rem 1.5rem;background:#f8fafc;border-bottom:2px solid #875D4A;">
                <div style="display:flex;justify-content:space-between;align-items:center;">
                    <h3 style="margin:0;color:#111;font-size:1.25rem;font-weight:600;">
                        <i class="pi pi-users" style="color:#875D4A;margin-right:0.5rem;"></i>
                        Colaboradores
                    </h3>
                    <p-tag [value]="colaboradores.length + ' colaboradores'" severity="secondary"></p-tag>
                </div>
            </div>
        </ng-template>

        <ng-template pTemplate="content">
            <div *ngIf="loading" style="text-align:center;padding:2rem;">
                <i class="pi pi-spin pi-spinner" style="font-size:2rem;color:#875D4A;"></i>
                <p style="margin:0.5rem 0 0;color:#64748b;">Cargando colaboradores...</p>
            </div>

            <div *ngIf="!loading && colaboradores.length === 0" style="padding:2rem;text-align:center;">
                <i class="pi pi-inbox" style="font-size:3rem;color:#cbd5e1;"></i>
                <p style="margin-top:1rem;color:#64748b;">No hay colaboradores registrados en este viaje</p>
            </div>

            <div *ngIf="!loading && colaboradores.length > 0"
                style="display:grid;grid-template-columns:repeat(2, 1fr);gap:1rem;">
                <div *ngFor="let colaborador of colaboradores; let i = index"
                    style="padding:1rem;border:2px solid #e2e8f0;border-radius:8px;background:white;">
                    <div style="display:flex;align-items:start;gap:1rem;">
                        <div
                            style="width:2.5rem;height:2.5rem;border-radius:50%;background:#875D4A;color:white;display:flex;align-items:center;justify-content:center;font-weight:600;flex-shrink:0;">
                            {{ i + 1 }}
                        </div>
                        <div style="flex:1;">
                            <div style="display:flex;justify-content:space-between;align-items:start;">
                                <div>
                                    <p style="margin:0;font-weight:600;color:#111;font-size:0.95rem;">
                                        {{ getColaboradorNombre(colaborador) }}
                                    </p>
                                    <p style="margin:0.25rem 0 0;color:#64748b;font-size:0.85rem;">
                                        {{ colaborador.colb_DNI }}
                                    </p>
                                </div>
                                <div style="text-align:right;">
                                    <p style="margin:0;color:#875D4A;font-weight:600;font-size:0.95rem;">
                                        {{ colaborador.distanciaViaje }} km
                                    </p>
                                </div>
                            </div>
                            <div style="margin-top:0.5rem;display:flex;gap:0.5rem;flex-wrap:wrap;">
                                <span
                                    style="padding:0.25rem 0.5rem;background:#f1f5f9;border-radius:4px;font-size:0.75rem;color:#64748b;">
                                    {{ colaborador.area_Descripcion }}
                                </span>
                                <span
                                    style="padding:0.25rem 0.5rem;background:#f1f5f9;border-radius:4px;font-size:0.75rem;color:#64748b;">
                                    {{ colaborador.carg_Descripcion }}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div *ngIf="!loading && colaboradores.length > 0"
                style="margin-top:1.5rem;padding:1rem;background:linear-gradient(135deg, #875D4A 0%, #6d4a3a 100%);border-radius:8px;color:white;">
                <div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:1.5rem;">
                    <div>
                        <p style="margin:0;font-size:0.85rem;opacity:0.9;">Distancia Total</p>
                        <p style="margin:0.25rem 0 0;font-size:1.5rem;font-weight:700;">
                            {{ getTotalDistancia() | number:'1.2-2' }} km
                        </p>
                    </div>
                    <div>
                        <p style="margin:0;font-size:0.85rem;opacity:0.9;">Colaboradores</p>
                        <p style="margin:0.25rem 0 0;font-size:1.5rem;font-weight:700;">
                            {{ colaboradores.length }}
                        </p>
                    </div>
                </div>
            </div>
        </ng-template>
    </p-card>

    <!-- Card 3: Auditoría -->
    <p-card [style]="{ 'border': '1px solid #e9e2db', 'border-radius': '12px' }">
        <ng-template pTemplate="header">
            <div style="padding:1.25rem 1.5rem;background:#f8fafc;border-bottom:2px solid #875D4A;">
                <h3 style="margin:0;color:#111;font-size:1.25rem;font-weight:600;">
                    <i class="pi pi-history" style="color:#875D4A;margin-right:0.5rem;"></i>
                    Auditoría
                </h3>
            </div>
        </ng-template>

        <ng-template pTemplate="content">
            <div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:1.5rem;">
                <div style="padding:1rem;border-left:4px solid #10b981;background:#f0fdf4;border-radius:4px;">
                    <p style="margin:0;color:#065f46;font-size:0.85rem;font-weight:600;">
                        <i class="pi pi-plus-circle"></i> CREADO
                    </p>
                    <p style="margin:0.5rem 0 0;color:#111;font-weight:600;">
                        {{ viaje.usuarioCreacion }}
                    </p>
                    <p style="margin:0.25rem 0 0;color:#64748b;font-size:0.85rem;">
                        {{ formatFecha(viaje.viaj_FechaCreacion) }}
                    </p>
                </div>

                <div *ngIf="viaje.usuarioModificacion"
                    style="padding:1rem;border-left:4px solid #f59e0b;background:#fffbeb;border-radius:4px;">
                    <p style="margin:0;color:#92400e;font-size:0.85rem;font-weight:600;">
                        <i class="pi pi-pencil"></i> MODIFICADO
                    </p>
                    <p style="margin:0.5rem 0 0;color:#111;font-weight:600;">
                        {{ viaje.usuarioModificacion }}
                    </p>
                    <p style="margin:0.25rem 0 0;color:#64748b;font-size:0.85rem;">
                        {{ formatFecha(viaje.viaj_FechaModificacion!) }}
                    </p>
                </div>

                <div *ngIf="!viaje.usuarioModificacion"
                    style="padding:1rem;border-left:4px solid #cbd5e1;background:#f8fafc;border-radius:4px;">
                    <p style="margin:0;color:#64748b;font-size:0.85rem;font-weight:600;">
                        <i class="pi pi-info-circle"></i> SIN MODIFICACIONES
                    </p>
                    <p style="margin:0.5rem 0 0;color:#64748b;font-size:0.9rem;">
                        Este viaje no ha sido modificado
                    </p>
                </div>
            </div>
        </ng-template>
    </p-card>
</div>